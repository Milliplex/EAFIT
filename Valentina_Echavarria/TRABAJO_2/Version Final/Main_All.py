productos_ecologicos = {
    "alimentos organicos": {
        'uva': {
            'descripcion': 'Fruta pequeña rica en antioxidantes que ayuda al corazón, común en supermercados y plazas de Medellín.',
            'impacto': 'bajo impacto'
        },
        'naranja': {
            'descripcion': 'Fruta cítrica alta en vitamina C que fortalece el sistema inmune, disponible en tiendas de frutas y supermercados.',
            'impacto': 'bajo impacto'
        },
        'manzana': {
            'descripcion': 'Fruta crujiente rica en fibra y antioxidantes, común en supermercados.',
            'impacto': 'bajo impacto'
        },
        'tomate': {
            'descripcion': 'Fruto rojo que es un antioxidante natural, se utiliza en ensaladas, salsas y jugos, disponible en cualquier supermercado.',
            'impacto': 'bajo impacto'
        },
        'lechuga': {
            'descripcion': 'Hoja verde fresca usada en ensaladas, rica en agua y fibra, se vende en tiendas de verduras.',
            'impacto': 'bajo impacto'
        },
        'zanahoria': {
            'descripcion': 'Raíz naranja con betacarotenos que mejora la visión, fácil de conseguir en cualquier tienda.',
            'impacto': 'bajo impacto'
        },
        'banano': {
            'descripcion': 'Fruta rica en potasio ideal para la energía, fácil de encontrar en tiendas de barrio y supermercados.',
            'impacto': 'bajo impacto'
        },
        'espinaca': {
            'descripcion': 'Hoja verde rica en hierro y vitaminas, ideal para la sangre, común en mercados.',
            'impacto': 'bajo impacto'
        },
        'pera': {
            'descripcion': 'Fruta dulce y jugosa con alto contenido de agua y fibra, disponible en tiendas de frutas.',
            'impacto': 'bajo impacto'
        },
        'arroz integral': {
            'descripcion': 'Grano entero rico en fibra para una mejor digestión, fácil de encontrar en supermercados.',
            'impacto': 'medio impacto'
        }
    },
    "higiene cosmetica": {
        'desodorante rexona': {
            'descripcion': 'Desodorante con protección duradera contra el sudor, disponible en tiendas de cuidado personal.',
            'impacto': 'alto impacto'
        },
        'crema dental colgate': {
            'descripcion': 'Pasta de dientes con propiedades antibacterianas para mantener una higiene bucal óptima, disponible en supermercados.',
            'impacto': 'alto impacto'
        },
        'maquillaje maybelline': {
            'descripcion': 'Maquillaje de uso cosmético, ideal para la piel, se consigue en tiendas de belleza.',
            'impacto': 'alto impacto'
        },
        'pañitos húmedos': {
            'descripcion': 'Toallitas para limpieza rápida de manos o superficies, disponibles en supermercados.',
            'impacto': 'medio impacto'
        },
        'alcohol': {
            'descripcion': 'Solución desinfectante usada para la higiene de manos o superficies, se encuentra en farmacias.',
            'impacto': 'medio impacto'
        },
        'algodón': {
            'descripcion': 'Material suave y absorbente usado para la higiene personal, comúnmente disponible en supermercados.',
            'impacto': 'medio impacto'
        },
        'mascarilla facial': {
            'descripcion': 'Tratamiento facial que hidrata y limpia la piel, disponible en tiendas de belleza.',
            'impacto': 'alto impacto'
        }
    },
    "alternativas sostenibles": {
        'pañales ecológicos': {
            'descripcion': 'Pañales reutilizables y ecológicos, ideales para reducir el impacto ambiental, disponibles en tiendas ecológicas.',
            'impacto': 'bajo impacto'
        },
        'cubiertos de bambú': {
            'descripcion': 'Utensilios biodegradables de bambú, ideales para eventos sostenibles, disponibles online.',
            'impacto': 'bajo impacto'
        },
        'envolturas de cera de abejas': {
            'descripcion': 'Alternativa ecológica a los plásticos, utilizadas para envolver alimentos, disponibles en tiendas naturales.',
            'impacto': 'bajo impacto'
        },
        'cepillos de dientes de bambú': {
            'descripcion': 'Cepillos de dientes sostenibles hechos de bambú, disponibles en tiendas ecológicas.',
            'impacto': 'bajo impacto'
        },
        'cargadores solares': {
            'descripcion': 'Cargadores para dispositivos electrónicos que funcionan con energía solar, disponibles en tiendas de tecnología.',
            'impacto': 'bajo impacto'
        },
        'productos biodegradables': {
            'descripcion': 'Productos que se descomponen naturalmente sin causar daño al medio ambiente.',
            'impacto': 'bajo impacto'
        },
        'productos compostables': {
            'descripcion': 'Productos que se pueden compostar después de su uso, disponibles en tiendas ecológicas.',
            'impacto': 'bajo impacto'
        },
        'productos reciclables': {
            'descripcion': 'Materiales que se pueden reciclar para reducir el desperdicio, disponibles en supermercados.',
            'impacto': 'medio impacto'
        }
    },
    "limpieza ecologica": {
        'limpiadores multiusos ecológicos': {
            'descripcion': 'Productos de limpieza sin químicos agresivos, ideales para la limpieza general.',
            'impacto': 'bajo impacto'
        },
        'esponjas vegetales': {
            'descripcion': 'Esponjas hechas de materiales naturales, compostables y ecológicas, disponibles en tiendas sostenibles.',
            'impacto': 'bajo impacto'
        },
        'paños de microfibra': {
            'descripcion': 'Paños eficientes para la limpieza sin productos químicos, se encuentran en tiendas de hogar.',
            'impacto': 'medio impacto'
        },
        'aceite esencial de árbol de té': {
            'descripcion': 'Aceite natural con propiedades antimicrobianas, usado en la limpieza y cosmética, disponible en tiendas naturales.',
            'impacto': 'bajo impacto'
        },
        'productos sin fragancias artificiales': {
            'descripcion': 'Productos de limpieza naturales sin químicos añadidos, disponibles en tiendas ecológicas.',
            'impacto': 'bajo impacto'
        }
    },
    "no especificada": {
        # Aquí irían productos cuya categoría aún no se define.
        'bota': {
            'descripcion': 'Para Construccion',
            'impacto': 'bajo impacto'
        }
    }
}


#LIBRERIAS USADAS

#Libreria Para Presentacion de los Productos Tipo Tabla
from tabulate import tabulate

#Libreria Para Graficar la cantidad de Productos que Hay por Categoria
import matplotlib.pyplot as plt

#DEFINICION DE FUNCIONES

#1 Añadir Productos a la Base de Datos
def anadir_pd():   
    nuevo_producto = input('Ingrese el Nombre del Producto: ').lower()

    # Verificar si el producto ya existe en alguna categoría
    if any(nuevo_producto in categoria for categoria in productos_ecologicos.values()):
        print("El producto ya existe en el sistema. No se puede volver a agregar.")
        
    else:
        descripcion_producto = input('Ingrese la Descripción del Producto: ')

        # Seleccionar el impacto ambiental con un micro menú
        impacto_producto = int(input("""Ingrese el Impacto Ambiental del Producto
        (1) Alto
        (2) Medio
        (3) Bajo
        (4) No Especificado
            """))
        if impacto_producto == 1:
            impacto = "alto"
        elif impacto_producto == 2:
            impacto = "medio"
        elif impacto_producto == 3:
            impacto = "bajo"
        elif impacto_producto == 4:
            impacto = "no especificado"
        else:
            print("Impacto no válido.")
            
        # Seleccionar la categoría con un micro menú
        agregar_categoria = int(input('Ingrese el Número de la Categoría a la que Pertenece el Producto: ' 
        """
        (1) Alimentos Orgánicos
        (2) Productos de Higiene y Cosmética
        (3) Alternativas Sostenibles
        (4) Productos de Limpieza Ecológicos
        (5) N/A
            """))

        if agregar_categoria == 1:
            productos_ecologicos['alimentos organicos'][nuevo_producto] = {'descripcion': descripcion_producto, 'impacto': impacto}
            print(f'El producto {nuevo_producto.title()} ha sido agregado a la categoría de Alimentos Orgánicos.')

        elif agregar_categoria == 2:
            productos_ecologicos['higiene cosmetica'][nuevo_producto] = {'descripcion': descripcion_producto, 'impacto': impacto}
            print(f'El producto {nuevo_producto.title()} ha sido agregado a la categoría de Higiene y Cosmética.')

        elif agregar_categoria == 3:
            productos_ecologicos['alternativas sostenibles'][nuevo_producto] = {'descripcion': descripcion_producto, 'impacto': impacto}
            print(f'El producto {nuevo_producto.title()} ha sido agregado a la categoría de Alternativas Sostenibles.')

        elif agregar_categoria == 4:
            productos_ecologicos['limpieza ecologica'][nuevo_producto] = {'descripcion': descripcion_producto, 'impacto': impacto}
            print(f'El producto {nuevo_producto.title()} ha sido agregado a la categoría de Limpieza Ecológica.')

        elif agregar_categoria == 5:
            categoria = "no especificada"
            productos_ecologicos['no especificada'][nuevo_producto] = {'descripcion': descripcion_producto, 'impacto': impacto}
            print(f'El producto {nuevo_producto.title()} ha sido agregado a la categoría "No especificada".')

        else:
            print('Categoría no válida.')
          
#2 Buscar Productos por Categoria
def buscar_pd_cat():
    buscador = int(input('¿Qué productos de qué categoría desea visualizar?: '
                         """

    (1) Alimentos Orgánicos
    (2) Productos de Higiene y Cosmética 
    (3) Alternativas Sostenibles
    (4) Productos de Limpieza Ecológicos
    (5) No Especificada
        """))

    if buscador == 1:
        categoria = 'alimentos organicos'
    elif buscador == 2:
        categoria = 'higiene cosmetica'
    elif buscador == 3:
        categoria = 'alternativas sostenibles'
    elif buscador == 4:
        categoria = 'limpieza ecologica'
    elif buscador == 5:
        categoria = 'no especificada'
    else:
        print('Categoría no válida.')
        

    # Obtener productos de la categoría seleccionada
    productos = productos_ecologicos.get(categoria, {})
    if productos:
        print(f"\n--- {categoria.title()} ---")
        tabla = [[producto.title(), datos['descripcion']] for producto, datos in productos.items()]
        print(tabulate(tabla, headers=["Producto", "Descripción"], tablefmt="fancy_grid"))
    else:
        print(f"No hay productos registrados en la categoría '{categoria.title()}'.")

#3 Verificar Existencia de un Producto en la Base de Datos
def verificar_existencia():   
    producto_a_buscar = input('Ingrese el Nombre del Producto a Buscar: ').lower()

    # Verificar si el producto ya existe en alguna categoría
    if any(producto_a_buscar in categoria for categoria in productos_ecologicos.values()):
        print(f"El Producto {producto_a_buscar.title()} ya existe en el Sistema")
    else:
        print(f"El Producto {producto_a_buscar.title()} no existe en el Sistema")

#4 Eliminar Producto de la Base de Datos
def eliminar_pd():
    producto_eliminar = input('Ingrese el Producto a Eliminar: ').lower()

    # Buscar y eliminar el producto de cualquier categoría
    for categoria in productos_ecologicos.values():
        if producto_eliminar in categoria:
            categoria.pop(producto_eliminar)
            print(f"El Producto {producto_eliminar.title()} ha sido eliminado con éxito")
            return  # Salir de la función una vez que el producto es eliminado

    # Si el producto no se encuentra
    print("Producto no encontrado")

#5 Actualizar Informacion/Descripcion de un Producto
def actualizar_inf_pd():
    producto_actualizar = input('Ingrese el Producto cuya Información desea Actualizar: ').lower()

    # Buscar el producto en cualquier categoría y actualizar su descripción
    for categoria in productos_ecologicos.values():
        if producto_actualizar in categoria:
            nueva_descripcion = input("Ingrese la nueva Descripción para el Producto: ")
            categoria[producto_actualizar]['descripcion'] = nueva_descripcion
            print(f"La información del producto {producto_actualizar.title()} ha sido actualizada con éxito.")
            return  # Salir de la función después de actualizar el producto

    # Si el producto no se encuentra
    print("Producto no encontrado. No se puede actualizar la información.")

#6 Ver Todos los Productos Ecologicos de la Base de Datos
def ver_pd_ec():
    # Recorre todas las categorías en el diccionario
    for categoria, productos in productos_ecologicos.items():
        print(f"\n--- {categoria.title()} ---")
        
        # Crea la tabla de productos para cada categoría
        tabla = [[producto.title(), datos['descripcion']] for producto, datos in productos.items()]
        
        # Muestra la tabla con tabulate
        print(tabulate(tabla, headers=["Producto", "Descripción"], tablefmt="fancy_grid"))

#7 Buscar Productos y Saber Cual es su Impacto Ambiental  
def buscar_pd_ia():
    buscador = input('Ingrese el Producto a Buscar: ').lower()
    encontrado = False

    for categoria, productos in productos_ecologicos.items():
        for producto, datos in productos.items():
            if producto == buscador:
                impacto = datos.get('impacto', 'No especificado').capitalize()
                print(f"El producto '{producto.title()}' pertenece a la categoría '{categoria.title()}' y es de: {impacto} Impacto Ambiental.")
                encontrado = True
                break
        if encontrado:
            break

    if not encontrado:
        print(f"El producto '{buscador.title()}' no se encuentra en el sistema.")

#8 Ver Grafica de Cantidad de Productos por Categoria  
def graficar_cantidad():
    # Extraer categorías y contar la cantidad de productos en cada una
    categorias = []
    cantidades = []

    for categoria, productos in productos_ecologicos.items():
        categorias.append(categoria.title())  # Capitaliza los nombres de las categorías
        cantidades.append(len(productos))     # Cuenta los productos en cada categoría

    # Crear gráfica de barras
    plt.figure(figsize=(10, 6))
    # Crea la Ventana de la Gráfica
    # Define tamaño en pulgadas de las gráficas

    plt.bar(categorias, cantidades, color=['green', 'pink', 'orange', 'blue', 'gray'])
    # Barras Verticales en el eje x

    plt.title('Cantidad de Productos por Categoría')
    # Título de la Gráfica

    plt.xlabel('Categorías')
    plt.ylabel('Cantidad de Productos')
    # Coloca las Etiquetas/Nombres de los ejes

    plt.tight_layout()
    # Ajusta los espacios entre las barras de las gráficas

    plt.show()
    # Muestra la Gráfica en la pantalla = print

#9 Añadir de Productos Mediante archivos .txt
def cargar_productos_desde_archivo(ruta_archivo):
    try:
        with open(ruta_archivo, 'r', encoding='utf-8') as archivo:
            for linea in archivo:
                linea = linea.strip()

                # Ignorar líneas que son comentarios (empiezan con /// o //)
                if linea.startswith("//") or not linea:
                    continue

                # Separar usando comas
                partes = linea.split(',')

                # Verificar que tenga 4 partes
                if len(partes) != 4:
                    print("Línea con formato incorrecto:", linea)
                    continue

                # Quitar espacios alrededor de cada parte
                nombre = partes[0].strip().lower()
                descripcion = partes[1].strip()
                impacto = partes[2].strip().lower()
                categoria = partes[3].strip().lower()

                # Verificar que la categoría exista
                if categoria in productos_ecologicos:
                    productos_ecologicos[categoria][nombre] = {
                        'descripcion': descripcion,
                        'impacto': impacto
                    }
                    print(f"Producto agregado: {nombre.title()}")
                else:
                    print(f"Categoría inválida: {categoria}")
    except FileNotFoundError:
        print("No se encontró el archivo:", ruta_archivo)

#---.---.---.---.---.---.#
print("""
                          ¡Hola Bienvenido!
    Este programa ha sido diseñado para ayudarte a conocer, gestionar y 
consultar una base de datos de productos ecológicos clasificados por 
                categoría y su impacto ambiental
""")

while True:
    print("""
--------------------------- MENÚ ---------------------------
    (1) Añadir Productos a la Base de Datos
    (2) Buscar Productos por Categoria
    (3) Busqueda de un Producto en la Base de Datos 
    (4) Eliminar un Producto de la Base de Datos
    (5) Actualizar Informacion de un Producto
    (6) Ver Todos los Productos Ecologicos
    (7) Buscar Productos y Saber Cual es su Impacto Ambiental  
    (8) Ver Grafica de Cantidad de Productos por Categoria  
    (9) Agregar o Modificar Productos Mediante archivo 'prodcutos.txt'
    (10) Salir del Programa
          
    Por favor, elige una opción del menú para continuar:
---------------------------- . ---------------------------- """)

    opcion = int(input('Ingrese la Opcion: '))

    # Añadir Productos a Listas
    if opcion == 1:
        anadir_pd()

    # Buscar Productos por Categoria
    elif opcion == 2:
        buscar_pd_cat()
 
    # Verificar Existencias
    elif opcion == 3:
        verificar_existencia()

    # Borrar Producto Especifico de la Base de datos
    elif opcion == 4:
        eliminar_pd()

    #Actualizar Informacion de un Producto
    elif opcion == 5:
        actualizar_inf_pd()

    # Ver Todos Los Productos Ecologicos
    elif opcion == 6:
        ver_pd_ec()

    # Buscar Productos y saber su Impacto Ambiental
    elif opcion == 7:
        buscar_pd_ia()

    #Ver Grafica de Cantidad de Productos por Categoria
    elif opcion == 8:
        graficar_cantidad()

    #Añadir Productos Mediante un archivo .txt
    elif opcion == 9:
        cargar_productos_desde_archivo("Codigo/productos.txt")

    # Salir
    elif opcion == 10:
        print("""
                        ¡Gracias por utilizar el Programa!
              
                        ¡Un pequeño cambio, un gran impacto! 
    Al utilizar productos ecológicos, puedes reducir la emisión de gases de efecto invernadero 
            en un 25% y disminuir la contaminación del agua en un 40%. 
    ¡Haz la diferencia y elige productos ecológicos para un futuro más verde y saludable!
              
saliendo del sistema...
        """)
        break

    else:
        print("Opción inválida. Por favor, inténtelo de nuevo.")
#---.---.---.---.---.---.#